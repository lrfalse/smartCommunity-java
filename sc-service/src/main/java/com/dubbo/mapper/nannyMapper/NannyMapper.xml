<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dubbo.mapper.nannyMapper.NannyMapper" >

  <sql id="Base_Column_List" >
    id, name, age, ethnic_id, ethnic, education, train_result, train_name, train_time,
    certificate, bill_health, identity_card, mob_phone, adress, photo_url, community_name,
    community_id, work_start_time, work_end_time, work_time, service_pnum
  </sql>

  <sql id="">
      <if test="name != null" >
          name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="age != null" >
          age = #{age,jdbcType=INTEGER},
      </if>
      <if test="ethnicId != null" >
          ethnic_id = #{ethnicId,jdbcType=BIGINT},
      </if>
      <if test="ethnic != null" >
          ethnic = #{ethnic,jdbcType=VARCHAR},
      </if>
      <if test="education != null" >
          education = #{education,jdbcType=BIT},
      </if>
      <if test="trainResult != null" >
          train_result = #{trainResult,jdbcType=VARCHAR},
      </if>
      <if test="trainName != null" >
          train_name = #{trainName,jdbcType=VARCHAR},
      </if>
      <if test="trainTime != null" >
          train_time = #{trainTime,jdbcType=TIMESTAMP},
      </if>
      <if test="certificate != null" >
          certificate = #{certificate,jdbcType=VARCHAR},
      </if>
      <if test="billHealth != null" >
          bill_health = #{billHealth,jdbcType=VARCHAR},
      </if>
      <if test="identityCard != null" >
          identity_card = #{identityCard,jdbcType=VARCHAR},
      </if>
      <if test="mobPhone != null" >
          mob_phone = #{mobPhone,jdbcType=VARCHAR},
      </if>
      <if test="adress != null" >
          adress = #{adress,jdbcType=VARCHAR},
      </if>
      <if test="photoUrl != null" >
          photo_url = #{photoUrl,jdbcType=VARCHAR},
      </if>
      <if test="communityName != null" >
          community_name = #{communityName,jdbcType=VARCHAR},
      </if>
      <if test="communityId != null" >
          community_id = #{communityId,jdbcType=BIGINT},
      </if>
      <if test="workStartTime != null" >
          work_start_time = #{workStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="workEndTime != null" >
          work_end_time = #{workEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="workTime != null" >
          work_time = #{workTime,jdbcType=INTEGER},
      </if>
      <if test="servicePnum != null" >
          service_pnum = #{servicePnum,jdbcType=INTEGER},
      </if>
  </sql>

  <update id="" parameterType="com.commons.entity.NannyEntity" >
    update t_nanny
    <set >
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="age != null" >
        age = #{age,jdbcType=INTEGER},
      </if>
      <if test="ethnicId != null" >
        ethnic_id = #{ethnicId,jdbcType=BIGINT},
      </if>
      <if test="ethnic != null" >
        ethnic = #{ethnic,jdbcType=VARCHAR},
      </if>
      <if test="education != null" >
        education = #{education,jdbcType=BIT},
      </if>
      <if test="trainResult != null" >
        train_result = #{trainResult,jdbcType=VARCHAR},
      </if>
      <if test="trainName != null" >
        train_name = #{trainName,jdbcType=VARCHAR},
      </if>
      <if test="trainTime != null" >
        train_time = #{trainTime,jdbcType=TIMESTAMP},
      </if>
      <if test="certificate != null" >
        certificate = #{certificate,jdbcType=VARCHAR},
      </if>
      <if test="billHealth != null" >
        bill_health = #{billHealth,jdbcType=VARCHAR},
      </if>
      <if test="identityCard != null" >
        identity_card = #{identityCard,jdbcType=VARCHAR},
      </if>
      <if test="mobPhone != null" >
        mob_phone = #{mobPhone,jdbcType=VARCHAR},
      </if>
      <if test="adress != null" >
        adress = #{adress,jdbcType=VARCHAR},
      </if>
      <if test="photoUrl != null" >
        photo_url = #{photoUrl,jdbcType=VARCHAR},
      </if>
      <if test="communityName != null" >
        community_name = #{communityName,jdbcType=VARCHAR},
      </if>
      <if test="communityId != null" >
        community_id = #{communityId,jdbcType=BIGINT},
      </if>
      <if test="workStartTime != null" >
        work_start_time = #{workStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="workEndTime != null" >
        work_end_time = #{workEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="workTime != null" >
        work_time = #{workTime,jdbcType=INTEGER},
      </if>
      <if test="servicePnum != null" >
        service_pnum = #{servicePnum,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>

    <select id="queryNanny" parameterType="ParamDto" resultType="com.commons.entity.NannyEntity">
       SELECT
        ty.name,
        ty.age,
        ty.community_name,
        ty.mob_phone,
        ty.work_time,
        tg.img_url,
        ty.community_id,
        ty.work_time,
        ty.type
       FROM t_nanny ty INNER JOIN t_nanny_img tg ON ty.id = tg.nanny_id
       <where>
           <if test="workTime != null" >
              AND work_time >=#{workTime,jdbcType=INTEGER}
           </if>
           <if test="type != null" >
               AND type = #{type}
           </if>
           <if test="communityId != null" >
               AND community_id =#{communityId}
           </if>
       </where>
        ORDER BY ty.work_time DESC
    </select>
</mapper>